{"version":3,"sources":["@wordpress/components/src/modal/frame.js"],"names":["classnames","Component","createRef","ESCAPE","focus","compose","IsolatedEventContainer","withFocusOutside","withFocusReturn","withConstrainedTabbing","ModalFrame","arguments","containerRef","handleKeyDown","bind","handleFocusOutside","focusFirstTabbable","props","focusOnMount","tabbables","tabbable","find","current","length","event","shouldCloseOnClickOutside","onRequestClose","keyCode","handleEscapeKeyDown","shouldCloseOnEsc","stopPropagation","overlayClassName","contentLabel","aria","describedby","labelledby","children","className","role","style"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\n\nimport { Component, createRef } from '@wordpress/element';\nimport { ESCAPE } from '@wordpress/keycodes';\nimport { focus } from '@wordpress/dom';\nimport { compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport IsolatedEventContainer from '../isolated-event-container';\nimport withFocusOutside from '../higher-order/with-focus-outside';\nimport withFocusReturn from '../higher-order/with-focus-return';\nimport withConstrainedTabbing from '../higher-order/with-constrained-tabbing';\n\nclass ModalFrame extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.containerRef = createRef();\n\t\tthis.handleKeyDown = this.handleKeyDown.bind( this );\n\t\tthis.handleFocusOutside = this.handleFocusOutside.bind( this );\n\t\tthis.focusFirstTabbable = this.focusFirstTabbable.bind( this );\n\t}\n\n\t/**\n\t * Focuses the first tabbable element when props.focusOnMount is true.\n\t */\n\tcomponentDidMount() {\n\t\t// Focus on mount\n\t\tif ( this.props.focusOnMount ) {\n\t\t\tthis.focusFirstTabbable();\n\t\t}\n\t}\n\n\t/**\n\t * Focuses the first tabbable element.\n\t */\n\tfocusFirstTabbable() {\n\t\tconst tabbables = focus.tabbable.find( this.containerRef.current );\n\t\tif ( tabbables.length ) {\n\t\t\ttabbables[ 0 ].focus();\n\t\t}\n\t}\n\n\t/**\n\t * Callback function called when clicked outside the modal.\n\t *\n\t * @param {Object} event Mouse click event.\n\t */\n\thandleFocusOutside( event ) {\n\t\tif ( this.props.shouldCloseOnClickOutside ) {\n\t\t\tthis.onRequestClose( event );\n\t\t}\n\t}\n\n\t/**\n\t * Callback function called when a key is pressed.\n\t *\n\t * @param {KeyboardEvent} event Key down event.\n\t */\n\thandleKeyDown( event ) {\n\t\tif ( event.keyCode === ESCAPE ) {\n\t\t\tthis.handleEscapeKeyDown( event );\n\t\t}\n\t}\n\n\t/**\n\t * Handles a escape key down event.\n\t *\n\t * Calls onRequestClose and prevents propagation of the event outside the modal.\n\t *\n\t * @param {Object} event Key down event.\n\t */\n\thandleEscapeKeyDown( event ) {\n\t\tif ( this.props.shouldCloseOnEsc ) {\n\t\t\tevent.stopPropagation();\n\t\t\tthis.onRequestClose( event );\n\t\t}\n\t}\n\n\t/**\n\t * Calls the onRequestClose callback props when it is available.\n\t *\n\t * @param {Object} event Event object.\n\t */\n\tonRequestClose( event ) {\n\t\tconst { onRequestClose } = this.props;\n\t\tif ( onRequestClose ) {\n\t\t\tonRequestClose( event );\n\t\t}\n\t}\n\n\t/**\n\t * Renders the modal frame element.\n\t *\n\t * @return {WPElement} The modal frame element.\n\t */\n\trender() {\n\t\tconst {\n\t\t\toverlayClassName,\n\t\t\tcontentLabel,\n\t\t\taria: {\n\t\t\t\tdescribedby,\n\t\t\t\tlabelledby,\n\t\t\t},\n\t\t\tchildren,\n\t\t\tclassName,\n\t\t\trole,\n\t\t\tstyle,\n\t\t} = this.props;\n\n\t\treturn (\n\t\t\t<IsolatedEventContainer\n\t\t\t\tclassName={ classnames( 'components-modal__screen-overlay', overlayClassName ) }\n\t\t\t\tonKeyDown={ this.handleKeyDown }\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t'components-modal__frame',\n\t\t\t\t\t\tclassName\n\t\t\t\t\t) }\n\t\t\t\t\tstyle={ style }\n\t\t\t\t\tref={ this.containerRef }\n\t\t\t\t\trole={ role }\n\t\t\t\t\taria-label={ contentLabel }\n\t\t\t\t\taria-labelledby={ contentLabel ? null : labelledby }\n\t\t\t\t\taria-describedby={ describedby }\n\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t>\n\t\t\t\t\t{ children }\n\t\t\t\t</div>\n\t\t\t</IsolatedEventContainer>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithFocusReturn,\n\twithConstrainedTabbing,\n\twithFocusOutside,\n] )( ModalFrame );\n"]}