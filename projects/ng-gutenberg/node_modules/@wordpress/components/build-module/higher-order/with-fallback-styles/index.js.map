{"version":3,"sources":["@wordpress/components/src/higher-order/with-fallback-styles/index.js"],"names":["every","isEqual","Component","createHigherOrderComponent","mapNodeToProps","WrappedComponent","arguments","nodeRef","props","node","state","fallbackStyles","undefined","grabStylesCompleted","bindRef","bind","grabFallbackStyles","newFallbackStyles","setState","wrappedComponent"],"mappings":";;;;;;;;;AAAA;;;AAGA,SAASA,KAAT,EAAgBC,OAAhB,QAA+B,QAA/B;AAEA;;;;AAGA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,0BAAT,QAA2C,oBAA3C;AAEA,gBAAe,UAAEC,cAAF;AAAA,SAAsBD,0BAA0B,CAC9D,UAAEE,gBAAF,EAAwB;AACvB;AAAA;AAAA;AAAA;;AACC,0BAAc;AAAA;;AAAA;;AACb,uFAAUC,SAAV;AACA,gBAAKC,OAAL,GAAe,MAAKC,KAAL,CAAWC,IAA1B;AACA,gBAAKC,KAAL,GAAa;AACZC,YAAAA,cAAc,EAAEC,SADJ;AAEZC,YAAAA,mBAAmB,EAAE;AAFT,WAAb;AAKA,gBAAKC,OAAL,GAAe,MAAKA,OAAL,CAAaC,IAAb,+BAAf;AARa;AASb;;AAVF;AAAA;AAAA,kCAYUN,IAZV,EAYiB;AACf,gBAAK,CAAEA,IAAP,EAAc;AACb;AACA;;AACD,iBAAKF,OAAL,GAAeE,IAAf;AACA;AAjBF;AAAA;AAAA,8CAmBqB;AACnB,iBAAKO,kBAAL;AACA;AArBF;AAAA;AAAA,+CAuBsB;AACpB,iBAAKA,kBAAL;AACA;AAzBF;AAAA;AAAA,+CA2BsB;AAAA,8BAC4B,KAAKN,KADjC;AAAA,gBACZG,mBADY,eACZA,mBADY;AAAA,gBACSF,cADT,eACSA,cADT;;AAEpB,gBAAK,KAAKJ,OAAL,IAAgB,CAAEM,mBAAvB,EAA6C;AAC5C,kBAAMI,iBAAiB,GAAGb,cAAc,CAAE,KAAKG,OAAP,EAAgB,KAAKC,KAArB,CAAxC;;AACA,kBAAK,CAAEP,OAAO,CAAEgB,iBAAF,EAAqBN,cAArB,CAAd,EAAsD;AACrD,qBAAKO,QAAL,CAAe;AACdP,kBAAAA,cAAc,EAAEM,iBADF;AAEdJ,kBAAAA,mBAAmB,EAAE,CAAC,CAAEb,KAAK,CAAEiB,iBAAF;AAFf,iBAAf;AAIA;AACD;AACD;AAtCF;AAAA;AAAA,mCAwCU;AACR,gBAAME,gBAAgB,GAAG,cAAC,gBAAD,eAAuB,KAAKX,KAA5B,EAAyC,KAAKE,KAAL,CAAWC,cAApD,EAAzB;AACA,mBAAO,KAAKH,KAAL,CAAWC,IAAX,GAAkBU,gBAAlB,GAAqC;AAAK,cAAA,GAAG,EAAG,KAAKL;AAAhB,oBAA6BK,gBAA7B,MAA5C;AACA;AA3CF;;AAAA;AAAA,QAAqBjB,SAArB;AAAA;AA6CA,GA/C6D,EAgD9D,oBAhD8D,CAAhD;AAAA,CAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { every, isEqual } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\nexport default ( mapNodeToProps ) => createHigherOrderComponent(\n\t( WrappedComponent ) => {\n\t\treturn class extends Component {\n\t\t\tconstructor() {\n\t\t\t\tsuper( ...arguments );\n\t\t\t\tthis.nodeRef = this.props.node;\n\t\t\t\tthis.state = {\n\t\t\t\t\tfallbackStyles: undefined,\n\t\t\t\t\tgrabStylesCompleted: false,\n\t\t\t\t};\n\n\t\t\t\tthis.bindRef = this.bindRef.bind( this );\n\t\t\t}\n\n\t\t\tbindRef( node ) {\n\t\t\t\tif ( ! node ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.nodeRef = node;\n\t\t\t}\n\n\t\t\tcomponentDidMount() {\n\t\t\t\tthis.grabFallbackStyles();\n\t\t\t}\n\n\t\t\tcomponentDidUpdate() {\n\t\t\t\tthis.grabFallbackStyles();\n\t\t\t}\n\n\t\t\tgrabFallbackStyles() {\n\t\t\t\tconst { grabStylesCompleted, fallbackStyles } = this.state;\n\t\t\t\tif ( this.nodeRef && ! grabStylesCompleted ) {\n\t\t\t\t\tconst newFallbackStyles = mapNodeToProps( this.nodeRef, this.props );\n\t\t\t\t\tif ( ! isEqual( newFallbackStyles, fallbackStyles ) ) {\n\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\tfallbackStyles: newFallbackStyles,\n\t\t\t\t\t\t\tgrabStylesCompleted: !! every( newFallbackStyles ),\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trender() {\n\t\t\t\tconst wrappedComponent = <WrappedComponent { ...this.props } { ...this.state.fallbackStyles } />;\n\t\t\t\treturn this.props.node ? wrappedComponent : <div ref={ this.bindRef }> { wrappedComponent } </div>;\n\t\t\t}\n\t\t};\n\t},\n\t'withFallbackStyles'\n);\n"]}