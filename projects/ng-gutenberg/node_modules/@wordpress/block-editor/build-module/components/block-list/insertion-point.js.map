{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/insertion-point.js"],"names":["classnames","Component","withSelect","Inserter","BlockInsertionPoint","arguments","state","isInserterFocused","onBlurInserter","bind","onFocusInserter","event","stopPropagation","setState","props","showInsertionPoint","rootClientId","clientId","select","getBlockIndex","getBlockInsertionPoint","isBlockInsertionPointVisible","blockIndex","insertionPoint","index"],"mappings":";;;;;;;;AAAA;;;AAGA,OAAOA,UAAP,MAAuB,YAAvB;AAEA;;;;AAGA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,UAAT,QAA2B,iBAA3B;AAEA;;;;AAGA,OAAOC,QAAP,MAAqB,aAArB;;IAEMC,mB;;;;;AACL,iCAAc;AAAA;;AAAA;;AACb,8FAAUC,SAAV;AACA,UAAKC,KAAL,GAAa;AACZC,MAAAA,iBAAiB,EAAE;AADP,KAAb;AAIA,UAAKC,cAAL,GAAsB,MAAKA,cAAL,CAAoBC,IAApB,+BAAtB;AACA,UAAKC,eAAL,GAAuB,MAAKA,eAAL,CAAqBD,IAArB,+BAAvB;AAPa;AAQb;;;;oCAEgBE,K,EAAQ;AACxB;AACA;AACA;AACAA,MAAAA,KAAK,CAACC,eAAN;AAEA,WAAKC,QAAL,CAAe;AACdN,QAAAA,iBAAiB,EAAE;AADL,OAAf;AAGA;;;qCAEgB;AAChB,WAAKM,QAAL,CAAe;AACdN,QAAAA,iBAAiB,EAAE;AADL,OAAf;AAGA;;;6BAEQ;AAAA,UACAA,iBADA,GACsB,KAAKD,KAD3B,CACAC,iBADA;AAAA,wBAMJ,KAAKO,KAND;AAAA,UAGPC,kBAHO,eAGPA,kBAHO;AAAA,UAIPC,YAJO,eAIPA,YAJO;AAAA,UAKPC,QALO,eAKPA,QALO;AAQR,aACC;AAAK,QAAA,SAAS,EAAC;AAAf,SACGF,kBAAkB,IACnB;AAAK,QAAA,SAAS,EAAC;AAAf,QAFF,EAIC;AACC,QAAA,OAAO,EAAG,KAAKL,eADhB;AAEC,QAAA,MAAM,EAAG,KAAKF,cAFf,CAGC;AACA;AACA;AACA;AACA;AACA;AARD;AASC,QAAA,QAAQ,EAAG,CAAC,CATb;AAUC,QAAA,SAAS,EACRR,UAAU,CAAE,+FAAF,EAAmG;AAC5G,wBAAcO;AAD8F,SAAnG;AAXZ,SAgBC,cAAC,QAAD;AACC,QAAA,YAAY,EAAGS,YADhB;AAEC,QAAA,QAAQ,EAAGC;AAFZ,QAhBD,CAJD,CADD;AA4BA;;;;EAhEgChB,S;;AAkElC,eAAeC,UAAU,CAAE,UAAEgB,MAAF,QAA0C;AAAA,MAA9BD,QAA8B,QAA9BA,QAA8B;AAAA,MAApBD,YAAoB,QAApBA,YAAoB;;AAAA,gBAKhEE,MAAM,CAAE,mBAAF,CAL0D;AAAA,MAEnEC,aAFmE,WAEnEA,aAFmE;AAAA,MAGnEC,sBAHmE,WAGnEA,sBAHmE;AAAA,MAInEC,4BAJmE,WAInEA,4BAJmE;;AAMpE,MAAMC,UAAU,GAAGH,aAAa,CAAEF,QAAF,EAAYD,YAAZ,CAAhC;AACA,MAAMO,cAAc,GAAGH,sBAAsB,EAA7C;AACA,MAAML,kBAAkB,GACvBM,4BAA4B,MAC5BE,cAAc,CAACC,KAAf,KAAyBF,UADzB,IAEAC,cAAc,CAACP,YAAf,KAAgCA,YAHjC;AAMA,SAAO;AAAED,IAAAA,kBAAkB,EAAlBA;AAAF,GAAP;AACA,CAfwB,CAAV,CAeVX,mBAfU,CAAf","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport Inserter from '../inserter';\n\nclass BlockInsertionPoint extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tisInserterFocused: false,\n\t\t};\n\n\t\tthis.onBlurInserter = this.onBlurInserter.bind( this );\n\t\tthis.onFocusInserter = this.onFocusInserter.bind( this );\n\t}\n\n\tonFocusInserter( event ) {\n\t\t// Stop propagation of the focus event to avoid selecting the current\n\t\t// block while inserting a new block, as it is not relevant to sibling\n\t\t// insertion and conflicts with contextual toolbar placement.\n\t\tevent.stopPropagation();\n\n\t\tthis.setState( {\n\t\t\tisInserterFocused: true,\n\t\t} );\n\t}\n\n\tonBlurInserter() {\n\t\tthis.setState( {\n\t\t\tisInserterFocused: false,\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { isInserterFocused } = this.state;\n\t\tconst {\n\t\t\tshowInsertionPoint,\n\t\t\trootClientId,\n\t\t\tclientId,\n\t\t} = this.props;\n\n\t\treturn (\n\t\t\t<div className=\"editor-block-list__insertion-point block-editor-block-list__insertion-point\">\n\t\t\t\t{ showInsertionPoint && (\n\t\t\t\t\t<div className=\"editor-block-list__insertion-point-indicator block-editor-block-list__insertion-point-indicator\" />\n\t\t\t\t) }\n\t\t\t\t<div\n\t\t\t\t\tonFocus={ this.onFocusInserter }\n\t\t\t\t\tonBlur={ this.onBlurInserter }\n\t\t\t\t\t// While ideally it would be enough to capture the\n\t\t\t\t\t// bubbling focus event from the Inserter, due to the\n\t\t\t\t\t// characteristics of click focusing of `button`s in\n\t\t\t\t\t// Firefox and Safari, it is not reliable.\n\t\t\t\t\t//\n\t\t\t\t\t// See: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#Clicking_and_focus\n\t\t\t\t\ttabIndex={ -1 }\n\t\t\t\t\tclassName={\n\t\t\t\t\t\tclassnames( 'editor-block-list__insertion-point-inserter block-editor-block-list__insertion-point-inserter', {\n\t\t\t\t\t\t\t'is-visible': isInserterFocused,\n\t\t\t\t\t\t} )\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<Inserter\n\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\nexport default withSelect( ( select, { clientId, rootClientId } ) => {\n\tconst {\n\t\tgetBlockIndex,\n\t\tgetBlockInsertionPoint,\n\t\tisBlockInsertionPointVisible,\n\t} = select( 'core/block-editor' );\n\tconst blockIndex = getBlockIndex( clientId, rootClientId );\n\tconst insertionPoint = getBlockInsertionPoint();\n\tconst showInsertionPoint = (\n\t\tisBlockInsertionPointVisible() &&\n\t\tinsertionPoint.index === blockIndex &&\n\t\tinsertionPoint.rootClientId === rootClientId\n\t);\n\n\treturn { showInsertionPoint };\n} )( BlockInsertionPoint );\n"]}