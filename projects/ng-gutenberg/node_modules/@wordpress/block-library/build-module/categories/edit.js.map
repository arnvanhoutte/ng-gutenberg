{"version":3,"sources":["@wordpress/block-library/src/categories/edit.js"],"names":["times","unescape","PanelBody","Placeholder","Spinner","ToggleControl","compose","withInstanceId","withSelect","InspectorControls","Component","__","CategoriesEdit","arguments","toggleDisplayAsDropdown","bind","toggleShowPostCounts","toggleShowHierarchy","props","attributes","setAttributes","displayAsDropdown","showPostCounts","showHierarchy","parentId","categories","length","filter","category","parent","level","name","trim","getCategories","getCategoryListClassName","map","renderCategoryListItem","childCategories","id","link","renderCategoryName","count","childCategory","instanceId","selectId","renderCategoryDropdownItem","isRequesting","inspectorControls","className","renderCategoryDropdown","renderCategoryList","select","getEntityRecords","isResolving","query","per_page","hide_empty"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { times, unescape } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { PanelBody, Placeholder, Spinner, ToggleControl } from '@wordpress/components';\nimport { compose, withInstanceId } from '@wordpress/compose';\nimport { withSelect } from '@wordpress/data';\nimport { InspectorControls } from '@wordpress/block-editor';\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\n\nclass CategoriesEdit extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.toggleDisplayAsDropdown = this.toggleDisplayAsDropdown.bind( this );\n\t\tthis.toggleShowPostCounts = this.toggleShowPostCounts.bind( this );\n\t\tthis.toggleShowHierarchy = this.toggleShowHierarchy.bind( this );\n\t}\n\n\ttoggleDisplayAsDropdown() {\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst { displayAsDropdown } = attributes;\n\n\t\tsetAttributes( { displayAsDropdown: ! displayAsDropdown } );\n\t}\n\n\ttoggleShowPostCounts() {\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst { showPostCounts } = attributes;\n\n\t\tsetAttributes( { showPostCounts: ! showPostCounts } );\n\t}\n\n\ttoggleShowHierarchy() {\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst { showHierarchy } = attributes;\n\n\t\tsetAttributes( { showHierarchy: ! showHierarchy } );\n\t}\n\n\tgetCategories( parentId = null ) {\n\t\tconst categories = this.props.categories;\n\t\tif ( ! categories || ! categories.length ) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif ( parentId === null ) {\n\t\t\treturn categories;\n\t\t}\n\n\t\treturn categories.filter( ( category ) => category.parent === parentId );\n\t}\n\n\tgetCategoryListClassName( level ) {\n\t\treturn `wp-block-categories__list wp-block-categories__list-level-${ level }`;\n\t}\n\n\trenderCategoryName( category ) {\n\t\tif ( ! category.name ) {\n\t\t\treturn __( '(Untitled)' );\n\t\t}\n\n\t\treturn unescape( category.name ).trim();\n\t}\n\n\trenderCategoryList() {\n\t\tconst { showHierarchy } = this.props.attributes;\n\t\tconst parentId = showHierarchy ? 0 : null;\n\t\tconst categories = this.getCategories( parentId );\n\n\t\treturn (\n\t\t\t<ul className={ this.getCategoryListClassName( 0 ) }>\n\t\t\t\t{ categories.map( ( category ) => this.renderCategoryListItem( category, 0 ) ) }\n\t\t\t</ul>\n\t\t);\n\t}\n\n\trenderCategoryListItem( category, level ) {\n\t\tconst { showHierarchy, showPostCounts } = this.props.attributes;\n\t\tconst childCategories = this.getCategories( category.id );\n\n\t\treturn (\n\t\t\t<li key={ category.id }>\n\t\t\t\t<a href={ category.link } target=\"_blank\" rel=\"noreferrer noopener\">{ this.renderCategoryName( category ) }</a>\n\t\t\t\t{ showPostCounts &&\n\t\t\t\t\t<span className=\"wp-block-categories__post-count\">\n\t\t\t\t\t\t{ ' ' }({ category.count })\n\t\t\t\t\t</span>\n\t\t\t\t}\n\n\t\t\t\t{\n\t\t\t\t\tshowHierarchy &&\n\t\t\t\t\t!! childCategories.length && (\n\t\t\t\t\t\t<ul className={ this.getCategoryListClassName( level + 1 ) }>\n\t\t\t\t\t\t\t{ childCategories.map( ( childCategory ) => this.renderCategoryListItem( childCategory, level + 1 ) ) }\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</li>\n\t\t);\n\t}\n\n\trenderCategoryDropdown() {\n\t\tconst { instanceId } = this.props;\n\t\tconst { showHierarchy } = this.props.attributes;\n\t\tconst parentId = showHierarchy ? 0 : null;\n\t\tconst categories = this.getCategories( parentId );\n\t\tconst selectId = `blocks-category-select-${ instanceId }`;\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<label htmlFor={ selectId } className=\"screen-reader-text\">\n\t\t\t\t\t{ __( 'Categories' ) }\n\t\t\t\t</label>\n\t\t\t\t<select id={ selectId } className=\"wp-block-categories__dropdown\">\n\t\t\t\t\t{ categories.map( ( category ) => this.renderCategoryDropdownItem( category, 0 ) ) }\n\t\t\t\t</select>\n\t\t\t</>\n\t\t);\n\t}\n\n\trenderCategoryDropdownItem( category, level ) {\n\t\tconst { showHierarchy, showPostCounts } = this.props.attributes;\n\t\tconst childCategories = this.getCategories( category.id );\n\n\t\treturn [\n\t\t\t<option key={ category.id }>\n\t\t\t\t{ times( level * 3, () => '\\xa0' ) }\n\t\t\t\t{ this.renderCategoryName( category ) }\n\t\t\t\t{\n\t\t\t\t\t!! showPostCounts ?\n\t\t\t\t\t\t` (${ category.count })` :\n\t\t\t\t\t\t''\n\t\t\t\t}\n\t\t\t</option>,\n\t\t\tshowHierarchy &&\n\t\t\t!! childCategories.length && (\n\t\t\t\tchildCategories.map( ( childCategory ) => this.renderCategoryDropdownItem( childCategory, level + 1 ) )\n\t\t\t),\n\t\t];\n\t}\n\n\trender() {\n\t\tconst { attributes, isRequesting } = this.props;\n\t\tconst { displayAsDropdown, showHierarchy, showPostCounts } = attributes;\n\n\t\tconst inspectorControls = (\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Categories Settings' ) }>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Display as Dropdown' ) }\n\t\t\t\t\t\tchecked={ displayAsDropdown }\n\t\t\t\t\t\tonChange={ this.toggleDisplayAsDropdown }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show Hierarchy' ) }\n\t\t\t\t\t\tchecked={ showHierarchy }\n\t\t\t\t\t\tonChange={ this.toggleShowHierarchy }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show Post Counts' ) }\n\t\t\t\t\t\tchecked={ showPostCounts }\n\t\t\t\t\t\tonChange={ this.toggleShowPostCounts }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t);\n\n\t\tif ( isRequesting ) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t{ inspectorControls }\n\t\t\t\t\t<Placeholder\n\t\t\t\t\t\ticon=\"admin-post\"\n\t\t\t\t\t\tlabel={ __( 'Categories' ) }\n\t\t\t\t\t>\n\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t</Placeholder>\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ inspectorControls }\n\t\t\t\t<div className={ this.props.className }>\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayAsDropdown ?\n\t\t\t\t\t\t\tthis.renderCategoryDropdown() :\n\t\t\t\t\t\t\tthis.renderCategoryList()\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n}\nexport default compose(\n\twithSelect( ( select ) => {\n\t\tconst { getEntityRecords } = select( 'core' );\n\t\tconst { isResolving } = select( 'core/data' );\n\t\tconst query = { per_page: -1, hide_empty: true };\n\n\t\treturn {\n\t\t\tcategories: getEntityRecords( 'taxonomy', 'category', query ),\n\t\t\tisRequesting: isResolving( 'core', 'getEntityRecords', [ 'taxonomy', 'category', query ] ),\n\t\t};\n\t} ),\n\twithInstanceId\n)( CategoriesEdit );\n"]}