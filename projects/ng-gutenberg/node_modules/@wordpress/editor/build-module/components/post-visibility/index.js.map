{"version":3,"sources":["@wordpress/editor/src/components/post-visibility/index.js"],"names":["__","Component","withInstanceId","compose","withSelect","withDispatch","visibilityOptions","PostVisibility","props","arguments","setPublic","bind","setPrivate","setPasswordProtected","updatePassword","state","hasPassword","password","visibility","onUpdateVisibility","status","setState","window","confirm","onSave","event","target","value","instanceId","visibilityHandlers","public","onSelect","checked","private","map","label","info","select","getEditedPostAttribute","getEditedPostVisibility","dispatch","savePost","editPost"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { visibilityOptions } from './utils';\n\nexport class PostVisibility extends Component {\n\tconstructor( props ) {\n\t\tsuper( ...arguments );\n\n\t\tthis.setPublic = this.setPublic.bind( this );\n\t\tthis.setPrivate = this.setPrivate.bind( this );\n\t\tthis.setPasswordProtected = this.setPasswordProtected.bind( this );\n\t\tthis.updatePassword = this.updatePassword.bind( this );\n\n\t\tthis.state = {\n\t\t\thasPassword: !! props.password,\n\t\t};\n\t}\n\n\tsetPublic() {\n\t\tconst { visibility, onUpdateVisibility, status } = this.props;\n\n\t\tonUpdateVisibility( visibility === 'private' ? 'draft' : status );\n\t\tthis.setState( { hasPassword: false } );\n\t}\n\n\tsetPrivate() {\n\t\tif ( ! window.confirm( __( 'Would you like to privately publish this post now?' ) ) ) { // eslint-disable-line no-alert\n\t\t\treturn;\n\t\t}\n\n\t\tconst { onUpdateVisibility, onSave } = this.props;\n\n\t\tonUpdateVisibility( 'private' );\n\t\tthis.setState( { hasPassword: false } );\n\t\tonSave();\n\t}\n\n\tsetPasswordProtected() {\n\t\tconst { visibility, onUpdateVisibility, status, password } = this.props;\n\n\t\tonUpdateVisibility( visibility === 'private' ? 'draft' : status, password || '' );\n\t\tthis.setState( { hasPassword: true } );\n\t}\n\n\tupdatePassword( event ) {\n\t\tconst { status, onUpdateVisibility } = this.props;\n\t\tonUpdateVisibility( status, event.target.value );\n\t}\n\n\trender() {\n\t\tconst { visibility, password, instanceId } = this.props;\n\n\t\tconst visibilityHandlers = {\n\t\t\tpublic: {\n\t\t\t\tonSelect: this.setPublic,\n\t\t\t\tchecked: visibility === 'public' && ! this.state.hasPassword,\n\t\t\t},\n\t\t\tprivate: {\n\t\t\t\tonSelect: this.setPrivate,\n\t\t\t\tchecked: visibility === 'private',\n\t\t\t},\n\t\t\tpassword: {\n\t\t\t\tonSelect: this.setPasswordProtected,\n\t\t\t\tchecked: this.state.hasPassword,\n\t\t\t},\n\t\t};\n\n\t\treturn [\n\t\t\t<fieldset key=\"visibility-selector\" className=\"editor-post-visibility__dialog-fieldset\">\n\t\t\t\t<legend className=\"editor-post-visibility__dialog-legend\">\n\t\t\t\t\t{ __( 'Post Visibility' ) }\n\t\t\t\t</legend>\n\t\t\t\t{ visibilityOptions.map( ( { value, label, info } ) => (\n\t\t\t\t\t<div key={ value } className=\"editor-post-visibility__choice\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\tname={ `editor-post-visibility__setting-${ instanceId }` }\n\t\t\t\t\t\t\tvalue={ value }\n\t\t\t\t\t\t\tonChange={ visibilityHandlers[ value ].onSelect }\n\t\t\t\t\t\t\tchecked={ visibilityHandlers[ value ].checked }\n\t\t\t\t\t\t\tid={ `editor-post-${ value }-${ instanceId }` }\n\t\t\t\t\t\t\taria-describedby={ `editor-post-${ value }-${ instanceId }-description` }\n\t\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-radio\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\thtmlFor={ `editor-post-${ value }-${ instanceId }` }\n\t\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-label\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ label }\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t{ <p id={ `editor-post-${ value }-${ instanceId }-description` } className=\"editor-post-visibility__dialog-info\">{ info }</p> }\n\t\t\t\t\t</div>\n\t\t\t\t) ) }\n\t\t\t</fieldset>,\n\t\t\tthis.state.hasPassword && (\n\t\t\t\t<div className=\"editor-post-visibility__dialog-password\" key=\"password-selector\">\n\t\t\t\t\t<label\n\t\t\t\t\t\thtmlFor={ `editor-post-visibility__dialog-password-input-${ instanceId }` }\n\t\t\t\t\t\tclassName=\"screen-reader-text\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Create password' ) }\n\t\t\t\t\t</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-password-input\"\n\t\t\t\t\t\tid={ `editor-post-visibility__dialog-password-input-${ instanceId }` }\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tonChange={ this.updatePassword }\n\t\t\t\t\t\tvalue={ password }\n\t\t\t\t\t\tplaceholder={ __( 'Use a secure password' ) }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t),\n\t\t];\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetEditedPostAttribute,\n\t\t\tgetEditedPostVisibility,\n\t\t} = select( 'core/editor' );\n\t\treturn {\n\t\t\tstatus: getEditedPostAttribute( 'status' ),\n\t\t\tvisibility: getEditedPostVisibility(),\n\t\t\tpassword: getEditedPostAttribute( 'password' ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { savePost, editPost } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\tonSave: savePost,\n\t\t\tonUpdateVisibility( status, password = '' ) {\n\t\t\t\teditPost( { status, password } );\n\t\t\t},\n\t\t};\n\t} ),\n\twithInstanceId,\n] )( PostVisibility );\n"]}