{"version":3,"sources":["@wordpress/editor/src/components/post-taxonomies/hierarchical-term-selector.js"],"names":["DEFAULT_QUERY","per_page","orderby","order","_fields","MIN_TERMS_COUNT_FOR_FILTER","HierarchicalTermSelector","arguments","findTerm","bind","onChange","onChangeFormName","onChangeFormParent","onAddTerm","onToggleForm","setFilterValue","sortBySelected","state","loading","availableTermsTree","availableTerms","adding","formName","formParent","showForm","filterValue","filteredTermsTree","termId","props","onUpdateTerms","terms","taxonomy","hasTerm","indexOf","newTerms","rest_base","event","newValue","target","value","trim","setState","newParent","parent","name","term","parseInt","toLowerCase","preventDefault","slug","existingTerm","id","addRequest","path","method","data","undefined","findOrCreatePromise","catch","error","errorCode","code","search","then","searchResult","Promise","reject","availableTerm","newAvailableTerms","termAddedMessage","speak","xhr","statusText","fetchTerms","fetchRequest","prevProps","termsTree","treeHasSelection","termTree","children","anyChildIsSelected","map","filter","child","length","termOrChildIsSelected","termA","termB","termASelected","termBSelected","sort","getFilterMatcher","getResultCount","count","i","resultCount","resultsFoundMessage","debouncedSpeak","matchTermsForFilter","originalTerm","renderedTerms","renderTerms","instanceId","hasCreateAction","hasAssignAction","labelWithFallback","labelProperty","fallbackIsCategory","fallbackIsNotCategory","newTermButtonLabel","newTermLabel","parentSelectLabel","noParentOption","newTermSubmitLabel","inputId","filterInputId","filterLabel","groupLabel","showFilter","Component","select","getCurrentPost","getTaxonomy","getEditedPostAttribute","dispatch","restBase","editPost","withSpokenMessages","withInstanceId"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { get, unescape as unescapeString, without, find, some, invoke } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, _x, _n, sprintf } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { CheckboxControl, TreeSelect, withSpokenMessages, withFilters, Button } from '@wordpress/components';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport apiFetch from '@wordpress/api-fetch';\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport { buildTermsTree } from '../../utils/terms';\n\n/**\n * Module Constants\n */\nconst DEFAULT_QUERY = {\n\tper_page: -1,\n\torderby: 'name',\n\torder: 'asc',\n\t_fields: 'id,name,parent',\n};\n\nconst MIN_TERMS_COUNT_FOR_FILTER = 8;\n\nclass HierarchicalTermSelector extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.findTerm = this.findTerm.bind( this );\n\t\tthis.onChange = this.onChange.bind( this );\n\t\tthis.onChangeFormName = this.onChangeFormName.bind( this );\n\t\tthis.onChangeFormParent = this.onChangeFormParent.bind( this );\n\t\tthis.onAddTerm = this.onAddTerm.bind( this );\n\t\tthis.onToggleForm = this.onToggleForm.bind( this );\n\t\tthis.setFilterValue = this.setFilterValue.bind( this );\n\t\tthis.sortBySelected = this.sortBySelected.bind( this );\n\t\tthis.state = {\n\t\t\tloading: true,\n\t\t\tavailableTermsTree: [],\n\t\t\tavailableTerms: [],\n\t\t\tadding: false,\n\t\t\tformName: '',\n\t\t\tformParent: '',\n\t\t\tshowForm: false,\n\t\t\tfilterValue: '',\n\t\t\tfilteredTermsTree: [],\n\t\t};\n\t}\n\n\tonChange( termId ) {\n\t\tconst { onUpdateTerms, terms = [], taxonomy } = this.props;\n\t\tconst hasTerm = terms.indexOf( termId ) !== -1;\n\t\tconst newTerms = hasTerm ?\n\t\t\twithout( terms, termId ) :\n\t\t\t[ ...terms, termId ];\n\t\tonUpdateTerms( newTerms, taxonomy.rest_base );\n\t}\n\n\tonChangeFormName( event ) {\n\t\tconst newValue = event.target.value.trim() === '' ? '' : event.target.value;\n\t\tthis.setState( { formName: newValue } );\n\t}\n\n\tonChangeFormParent( newParent ) {\n\t\tthis.setState( { formParent: newParent } );\n\t}\n\n\tonToggleForm() {\n\t\tthis.setState( ( state ) => ( {\n\t\t\tshowForm: ! state.showForm,\n\t\t} ) );\n\t}\n\n\tfindTerm( terms, parent, name ) {\n\t\treturn find( terms, ( term ) => {\n\t\t\treturn ( ( ! term.parent && ! parent ) || parseInt( term.parent ) === parseInt( parent ) ) &&\n\t\t\t\tterm.name.toLowerCase() === name.toLowerCase();\n\t\t} );\n\t}\n\n\tonAddTerm( event ) {\n\t\tevent.preventDefault();\n\t\tconst { onUpdateTerms, taxonomy, terms, slug } = this.props;\n\t\tconst { formName, formParent, adding, availableTerms } = this.state;\n\t\tif ( formName === '' || adding ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// check if the term we are adding already exists\n\t\tconst existingTerm = this.findTerm( availableTerms, formParent, formName );\n\t\tif ( existingTerm ) {\n\t\t\t// if the term we are adding exists but is not selected select it\n\t\t\tif ( ! some( terms, ( term ) => term === existingTerm.id ) ) {\n\t\t\t\tonUpdateTerms( [ ...terms, existingTerm.id ], taxonomy.rest_base );\n\t\t\t}\n\t\t\tthis.setState( {\n\t\t\t\tformName: '',\n\t\t\t\tformParent: '',\n\t\t\t} );\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState( {\n\t\t\tadding: true,\n\t\t} );\n\t\tthis.addRequest = apiFetch( {\n\t\t\tpath: `/wp/v2/${ taxonomy.rest_base }`,\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\tname: formName,\n\t\t\t\tparent: formParent ? formParent : undefined,\n\t\t\t},\n\t\t} );\n\t\t// Tries to create a term or fetch it if it already exists\n\t\tconst findOrCreatePromise = this.addRequest\n\t\t\t.catch( ( error ) => {\n\t\t\t\tconst errorCode = error.code;\n\t\t\t\tif ( errorCode === 'term_exists' ) {\n\t\t\t\t\t// search the new category created since last fetch\n\t\t\t\t\tthis.addRequest = apiFetch( {\n\t\t\t\t\t\tpath: addQueryArgs(\n\t\t\t\t\t\t\t`/wp/v2/${ taxonomy.rest_base }`,\n\t\t\t\t\t\t\t{ ...DEFAULT_QUERY, parent: formParent || 0, search: formName }\n\t\t\t\t\t\t),\n\t\t\t\t\t} );\n\t\t\t\t\treturn this.addRequest\n\t\t\t\t\t\t.then( ( searchResult ) => {\n\t\t\t\t\t\t\treturn this.findTerm( searchResult, formParent, formName );\n\t\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\treturn Promise.reject( error );\n\t\t\t} );\n\t\tfindOrCreatePromise\n\t\t\t.then( ( term ) => {\n\t\t\t\tconst hasTerm = !! find( this.state.availableTerms, ( availableTerm ) => availableTerm.id === term.id );\n\t\t\t\tconst newAvailableTerms = hasTerm ? this.state.availableTerms : [ term, ...this.state.availableTerms ];\n\t\t\t\tconst termAddedMessage = sprintf(\n\t\t\t\t\t_x( '%s added', 'term' ),\n\t\t\t\t\tget(\n\t\t\t\t\t\tthis.props.taxonomy,\n\t\t\t\t\t\t[ 'labels', 'singular_name' ],\n\t\t\t\t\t\tslug === 'category' ? __( 'Category' ) : __( 'Term' )\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\tthis.props.speak( termAddedMessage, 'assertive' );\n\t\t\t\tthis.addRequest = null;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tadding: false,\n\t\t\t\t\tformName: '',\n\t\t\t\t\tformParent: '',\n\t\t\t\t\tavailableTerms: newAvailableTerms,\n\t\t\t\t\tavailableTermsTree: this.sortBySelected( buildTermsTree( newAvailableTerms ) ),\n\t\t\t\t} );\n\t\t\t\tonUpdateTerms( [ ...terms, term.id ], taxonomy.rest_base );\n\t\t\t}, ( xhr ) => {\n\t\t\t\tif ( xhr.statusText === 'abort' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.addRequest = null;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tadding: false,\n\t\t\t\t} );\n\t\t\t} );\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.fetchTerms();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tinvoke( this.fetchRequest, [ 'abort' ] );\n\t\tinvoke( this.addRequest, [ 'abort' ] );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( this.props.taxonomy !== prevProps.taxonomy ) {\n\t\t\tthis.fetchTerms();\n\t\t}\n\t}\n\n\tfetchTerms() {\n\t\tconst { taxonomy } = this.props;\n\t\tif ( ! taxonomy ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.fetchRequest = apiFetch( {\n\t\t\tpath: addQueryArgs( `/wp/v2/${ taxonomy.rest_base }`, DEFAULT_QUERY ),\n\t\t} );\n\t\tthis.fetchRequest.then(\n\t\t\t( terms ) => { // resolve\n\t\t\t\tconst availableTermsTree = this.sortBySelected( buildTermsTree( terms ) );\n\n\t\t\t\tthis.fetchRequest = null;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tloading: false,\n\t\t\t\t\tavailableTermsTree,\n\t\t\t\t\tavailableTerms: terms,\n\t\t\t\t} );\n\t\t\t},\n\t\t\t( xhr ) => { // reject\n\t\t\t\tif ( xhr.statusText === 'abort' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.fetchRequest = null;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tloading: false,\n\t\t\t\t} );\n\t\t\t}\n\t\t);\n\t}\n\n\tsortBySelected( termsTree ) {\n\t\tconst { terms } = this.props;\n\t\tconst treeHasSelection = ( termTree ) => {\n\t\t\tif ( terms.indexOf( termTree.id ) !== -1 ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif ( undefined === termTree.children ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst anyChildIsSelected = termTree.children.map( treeHasSelection ).filter( ( child ) => child ).length > 0;\n\t\t\tif ( anyChildIsSelected ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tconst termOrChildIsSelected = ( termA, termB ) => {\n\t\t\tconst termASelected = treeHasSelection( termA );\n\t\t\tconst termBSelected = treeHasSelection( termB );\n\n\t\t\tif ( termASelected === termBSelected ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif ( termASelected && ! termBSelected ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif ( ! termASelected && termBSelected ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t};\n\t\ttermsTree.sort( termOrChildIsSelected );\n\t\treturn termsTree;\n\t}\n\n\tsetFilterValue( event ) {\n\t\tconst { availableTermsTree } = this.state;\n\t\tconst filterValue = event.target.value;\n\t\tconst filteredTermsTree = availableTermsTree.map( this.getFilterMatcher( filterValue ) ).filter( ( term ) => term );\n\t\tconst getResultCount = ( terms ) => {\n\t\t\tlet count = 0;\n\t\t\tfor ( let i = 0; i < terms.length; i++ ) {\n\t\t\t\tcount++;\n\t\t\t\tif ( undefined !== terms[ i ].children ) {\n\t\t\t\t\tcount += getResultCount( terms[ i ].children );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn count;\n\t\t};\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tfilterValue,\n\t\t\t\tfilteredTermsTree,\n\t\t\t}\n\t\t);\n\n\t\tconst resultCount = getResultCount( filteredTermsTree );\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t_n( '%d result found.', '%d results found.', resultCount ),\n\t\t\tresultCount\n\t\t);\n\t\tthis.props.debouncedSpeak( resultsFoundMessage, 'assertive' );\n\t}\n\n\tgetFilterMatcher( filterValue ) {\n\t\tconst matchTermsForFilter = ( originalTerm ) => {\n\t\t\tif ( '' === filterValue ) {\n\t\t\t\treturn originalTerm;\n\t\t\t}\n\n\t\t\t// Shallow clone, because we'll be filtering the term's children and\n\t\t\t// don't want to modify the original term.\n\t\t\tconst term = { ...originalTerm };\n\n\t\t\t// Map and filter the children, recursive so we deal with grandchildren\n\t\t\t// and any deeper levels.\n\t\t\tif ( term.children.length > 0 ) {\n\t\t\t\tterm.children = term.children.map( matchTermsForFilter ).filter( ( child ) => child );\n\t\t\t}\n\n\t\t\t// If the term's name contains the filterValue, or it has children\n\t\t\t// (i.e. some child matched at some point in the tree) then return it.\n\t\t\tif ( -1 !== term.name.toLowerCase().indexOf( filterValue.toLowerCase() ) || term.children.length > 0 ) {\n\t\t\t\treturn term;\n\t\t\t}\n\n\t\t\t// Otherwise, return false. After mapping, the list of terms will need\n\t\t\t// to have false values filtered out.\n\t\t\treturn false;\n\t\t};\n\t\treturn matchTermsForFilter;\n\t}\n\n\trenderTerms( renderedTerms ) {\n\t\tconst { terms = [] } = this.props;\n\t\treturn renderedTerms.map( ( term ) => {\n\t\t\treturn (\n\t\t\t\t<div key={ term.id } className=\"editor-post-taxonomies__hierarchical-terms-choice\">\n\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\tchecked={ terms.indexOf( term.id ) !== -1 }\n\t\t\t\t\t\tonChange={ () => {\n\t\t\t\t\t\t\tconst termId = parseInt( term.id, 10 );\n\t\t\t\t\t\t\tthis.onChange( termId );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tlabel={ unescapeString( term.name ) }\n\t\t\t\t\t/>\n\t\t\t\t\t{ !! term.children.length && (\n\t\t\t\t\t\t<div className=\"editor-post-taxonomies__hierarchical-terms-subchoices\">\n\t\t\t\t\t\t\t{ this.renderTerms( term.children ) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t);\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { slug, taxonomy, instanceId, hasCreateAction, hasAssignAction } = this.props;\n\n\t\tif ( ! hasAssignAction ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { availableTermsTree, availableTerms, filteredTermsTree, formName, formParent, loading, showForm, filterValue } = this.state;\n\t\tconst labelWithFallback = ( labelProperty, fallbackIsCategory, fallbackIsNotCategory ) => get(\n\t\t\ttaxonomy,\n\t\t\t[ 'labels', labelProperty ],\n\t\t\tslug === 'category' ? fallbackIsCategory : fallbackIsNotCategory\n\t\t);\n\t\tconst newTermButtonLabel = labelWithFallback(\n\t\t\t'add_new_item',\n\t\t\t__( 'Add new category' ),\n\t\t\t__( 'Add new term' )\n\t\t);\n\t\tconst newTermLabel = labelWithFallback(\n\t\t\t'new_item_name',\n\t\t\t__( 'Add new category' ),\n\t\t\t__( 'Add new term' )\n\t\t);\n\t\tconst parentSelectLabel = labelWithFallback(\n\t\t\t'parent_item',\n\t\t\t__( 'Parent Category' ),\n\t\t\t__( 'Parent Term' )\n\t\t);\n\t\tconst noParentOption = `— ${ parentSelectLabel } —`;\n\t\tconst newTermSubmitLabel = newTermButtonLabel;\n\t\tconst inputId = `editor-post-taxonomies__hierarchical-terms-input-${ instanceId }`;\n\t\tconst filterInputId = `editor-post-taxonomies__hierarchical-terms-filter-${ instanceId }`;\n\t\tconst filterLabel = get(\n\t\t\tthis.props.taxonomy,\n\t\t\t[ 'labels', 'search_items' ],\n\t\t\t__( 'Search Terms' )\n\t\t);\n\t\tconst groupLabel = get(\n\t\t\tthis.props.taxonomy,\n\t\t\t[ 'name' ],\n\t\t\t__( 'Terms' )\n\t\t);\n\t\tconst showFilter = availableTerms.length >= MIN_TERMS_COUNT_FOR_FILTER;\n\n\t\treturn [\n\t\t\tshowFilter && <label\n\t\t\t\tkey=\"filter-label\"\n\t\t\t\thtmlFor={ filterInputId }>\n\t\t\t\t{ filterLabel }\n\t\t\t</label>,\n\t\t\tshowFilter && <input\n\t\t\t\ttype=\"search\"\n\t\t\t\tid={ filterInputId }\n\t\t\t\tvalue={ filterValue }\n\t\t\t\tonChange={ this.setFilterValue }\n\t\t\t\tclassName=\"editor-post-taxonomies__hierarchical-terms-filter\"\n\t\t\t\tkey=\"term-filter-input\"\n\t\t\t/>,\n\t\t\t<div\n\t\t\t\tclassName=\"editor-post-taxonomies__hierarchical-terms-list\"\n\t\t\t\tkey=\"term-list\"\n\t\t\t\ttabIndex=\"0\"\n\t\t\t\trole=\"group\"\n\t\t\t\taria-label={ groupLabel }\n\t\t\t>\n\t\t\t\t{ this.renderTerms( '' !== filterValue ? filteredTermsTree : availableTermsTree ) }\n\t\t\t</div>,\n\t\t\t! loading && hasCreateAction && (\n\t\t\t\t<Button\n\t\t\t\t\tkey=\"term-add-button\"\n\t\t\t\t\tonClick={ this.onToggleForm }\n\t\t\t\t\tclassName=\"editor-post-taxonomies__hierarchical-terms-add\"\n\t\t\t\t\taria-expanded={ showForm }\n\t\t\t\t\tisLink\n\t\t\t\t>\n\t\t\t\t\t{ newTermButtonLabel }\n\t\t\t\t</Button>\n\t\t\t),\n\t\t\tshowForm && (\n\t\t\t\t<form onSubmit={ this.onAddTerm } key=\"hierarchical-terms-form\">\n\t\t\t\t\t<label\n\t\t\t\t\t\thtmlFor={ inputId }\n\t\t\t\t\t\tclassName=\"editor-post-taxonomies__hierarchical-terms-label\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{ newTermLabel }\n\t\t\t\t\t</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tid={ inputId }\n\t\t\t\t\t\tclassName=\"editor-post-taxonomies__hierarchical-terms-input\"\n\t\t\t\t\t\tvalue={ formName }\n\t\t\t\t\t\tonChange={ this.onChangeFormName }\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t{ !! availableTerms.length &&\n\t\t\t\t\t\t<TreeSelect\n\t\t\t\t\t\t\tlabel={ parentSelectLabel }\n\t\t\t\t\t\t\tnoOptionLabel={ noParentOption }\n\t\t\t\t\t\t\tonChange={ this.onChangeFormParent }\n\t\t\t\t\t\t\tselectedId={ formParent }\n\t\t\t\t\t\t\ttree={ availableTermsTree }\n\t\t\t\t\t\t/>\n\t\t\t\t\t}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tisDefault\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\tclassName=\"editor-post-taxonomies__hierarchical-terms-submit\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{ newTermSubmitLabel }\n\t\t\t\t\t</Button>\n\t\t\t\t</form>\n\t\t\t),\n\t\t];\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, { slug } ) => {\n\t\tconst { getCurrentPost } = select( 'core/editor' );\n\t\tconst { getTaxonomy } = select( 'core' );\n\t\tconst taxonomy = getTaxonomy( slug );\n\t\treturn {\n\t\t\thasCreateAction: taxonomy ? get( getCurrentPost(), [ '_links', 'wp:action-create-' + taxonomy.rest_base ], false ) : false,\n\t\t\thasAssignAction: taxonomy ? get( getCurrentPost(), [ '_links', 'wp:action-assign-' + taxonomy.rest_base ], false ) : false,\n\t\t\tterms: taxonomy ? select( 'core/editor' ).getEditedPostAttribute( taxonomy.rest_base ) : [],\n\t\t\ttaxonomy,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => ( {\n\t\tonUpdateTerms( terms, restBase ) {\n\t\t\tdispatch( 'core/editor' ).editPost( { [ restBase ]: terms } );\n\t\t},\n\t} ) ),\n\twithSpokenMessages,\n\twithInstanceId,\n\twithFilters( 'editor.PostTaxonomyType' ),\n] )( HierarchicalTermSelector );\n"]}