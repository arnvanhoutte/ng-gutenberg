{"version":3,"sources":["@wordpress/blocks/src/api/raw-handling/list-reducer.js"],"names":["isList","node","nodeName","shallowTextContent","element","childNodes","map","nodeValue","join","list","prevElement","previousElementSibling","children","length","firstChild","appendChild","parentNode","removeChild","parentElement","test","parentListItem","prevListItem","parentList","insertBefore"],"mappings":";;;;;;;;;;;AAGA;;AAHA;;;AAKA,SAASA,MAAT,CAAiBC,IAAjB,EAAwB;AACvB,SAAOA,IAAI,CAACC,QAAL,KAAkB,IAAlB,IAA0BD,IAAI,CAACC,QAAL,KAAkB,IAAnD;AACA;;AAED,SAASC,kBAAT,CAA6BC,OAA7B,EAAuC;AACtC,SAAO,iCAAKA,OAAO,CAACC,UAAb,EACLC,GADK,CACA;AAAA,8BAAIC,SAAJ;AAAA,QAAIA,SAAJ,+BAAgB,EAAhB;AAAA,WAA0BA,SAA1B;AAAA,GADA,EAELC,IAFK,CAEC,EAFD,CAAP;AAGA;;AAEc,kBAAUP,IAAV,EAAiB;AAC/B,MAAK,CAAED,MAAM,CAAEC,IAAF,CAAb,EAAwB;AACvB;AACA;;AAED,MAAMQ,IAAI,GAAGR,IAAb;AACA,MAAMS,WAAW,GAAGT,IAAI,CAACU,sBAAzB,CAN+B,CAQ/B;AACA;AACA;;AACA,MACCD,WAAW,IACXA,WAAW,CAACR,QAAZ,KAAyBD,IAAI,CAACC,QAD9B,IAEAO,IAAI,CAACG,QAAL,CAAcC,MAAd,KAAyB,CAH1B,EAIE;AACD;AACA,WAAQJ,IAAI,CAACK,UAAb,EAA0B;AACzBJ,MAAAA,WAAW,CAACK,WAAZ,CAAyBN,IAAI,CAACK,UAA9B;AACA;;AAEDL,IAAAA,IAAI,CAACO,UAAL,CAAgBC,WAAhB,CAA6BR,IAA7B;AACA;;AAED,MAAMS,aAAa,GAAGjB,IAAI,CAACe,UAA3B,CAxB+B,CA0B/B;;AACA,MACCE,aAAa,IACbA,aAAa,CAAChB,QAAd,KAA2B,IAD3B,IAEAgB,aAAa,CAACN,QAAd,CAAuBC,MAAvB,KAAkC,CAFlC,IAGA,CAAE,KAAKM,IAAL,CAAWhB,kBAAkB,CAAEe,aAAF,CAA7B,CAJH,EAKE;AACD,QAAME,cAAc,GAAGF,aAAvB;AACA,QAAMG,YAAY,GAAGD,cAAc,CAACT,sBAApC;AACA,QAAMW,UAAU,GAAGF,cAAc,CAACJ,UAAlC;;AAEA,QAAKK,YAAL,EAAoB;AACnBA,MAAAA,YAAY,CAACN,WAAb,CAA0BN,IAA1B;AACAa,MAAAA,UAAU,CAACL,WAAX,CAAwBG,cAAxB;AACA,KAHD,MAGO;AACNE,MAAAA,UAAU,CAACN,UAAX,CAAsBO,YAAtB,CAAoCd,IAApC,EAA0Ca,UAA1C;AACAA,MAAAA,UAAU,CAACN,UAAX,CAAsBC,WAAtB,CAAmCK,UAAnC;AACA;AACD,GA5C8B,CA8C/B;;;AACA,MAAKJ,aAAa,IAAIlB,MAAM,CAAEkB,aAAF,CAA5B,EAAgD;AAC/C,QAAMG,aAAY,GAAGpB,IAAI,CAACU,sBAA1B;;AAEA,QAAKU,aAAL,EAAoB;AACnBA,MAAAA,aAAY,CAACN,WAAb,CAA0Bd,IAA1B;AACA,KAFD,MAEO;AACN,uBAAQA,IAAR;AACA;AACD;AACD","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { unwrap } from '@wordpress/dom';\n\nfunction isList( node ) {\n\treturn node.nodeName === 'OL' || node.nodeName === 'UL';\n}\n\nfunction shallowTextContent( element ) {\n\treturn [ ...element.childNodes ]\n\t\t.map( ( { nodeValue = '' } ) => nodeValue )\n\t\t.join( '' );\n}\n\nexport default function( node ) {\n\tif ( ! isList( node ) ) {\n\t\treturn;\n\t}\n\n\tconst list = node;\n\tconst prevElement = node.previousElementSibling;\n\n\t// Merge with previous list if:\n\t// * There is a previous list of the same type.\n\t// * There is only one list item.\n\tif (\n\t\tprevElement &&\n\t\tprevElement.nodeName === node.nodeName &&\n\t\tlist.children.length === 1\n\t) {\n\t\t// Move all child nodes, including any text nodes, if any.\n\t\twhile ( list.firstChild ) {\n\t\t\tprevElement.appendChild( list.firstChild );\n\t\t}\n\n\t\tlist.parentNode.removeChild( list );\n\t}\n\n\tconst parentElement = node.parentNode;\n\n\t// Nested list with empty parent item.\n\tif (\n\t\tparentElement &&\n\t\tparentElement.nodeName === 'LI' &&\n\t\tparentElement.children.length === 1 &&\n\t\t! /\\S/.test( shallowTextContent( parentElement ) )\n\t) {\n\t\tconst parentListItem = parentElement;\n\t\tconst prevListItem = parentListItem.previousElementSibling;\n\t\tconst parentList = parentListItem.parentNode;\n\n\t\tif ( prevListItem ) {\n\t\t\tprevListItem.appendChild( list );\n\t\t\tparentList.removeChild( parentListItem );\n\t\t} else {\n\t\t\tparentList.parentNode.insertBefore( list, parentList );\n\t\t\tparentList.parentNode.removeChild( parentList );\n\t\t}\n\t}\n\n\t// Invalid: OL/UL > OL/UL.\n\tif ( parentElement && isList( parentElement ) ) {\n\t\tconst prevListItem = node.previousElementSibling;\n\n\t\tif ( prevListItem ) {\n\t\t\tprevListItem.appendChild( node );\n\t\t} else {\n\t\t\tunwrap( node );\n\t\t}\n\t}\n}\n"]}